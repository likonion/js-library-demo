<!DOCTYPE html>
<html lang="en">

<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<title>原生JavaScript-OO轮播实现</title>
	<link rel="stylesheet" href="css/style.css">
</head>

<body>
	<div class="out" id="mainBox">
		<ul class="slideBox img">
			<li>
				<a href="#">
					<img src="images/1.jpg" alt="">
				</a>
			</li>
			<li>
				<a href="#">
					<img src="images/2.jpg" alt="">
				</a>
			</li>
			<li>
				<a href="#">
					<img src="images/3.jpg" alt="">
				</a>
			</li>
			<li>
				<a href="#">
					<img src="images/4.jpg" alt="">
				</a>
			</li>
			<li>
				<a href="#">
					<img src="images/5.jpg" alt="">
				</a>
			</li>
			<li>
				<a href="#">
					<img src="images/6.jpg" alt="">
				</a>
			</li>
		</ul>


		<ul class="numBox num">
			<li class="active">1</li>
			<li>2</li>
			<li>3</li>
			<li>4</li>
			<li>5</li>
			<li>6</li>
		</ul>

		<div class="preImg left btn">&lt;</div>
		<div class="nextImg right btn">&gt;</div>


	</div>
	<div class="out" id="mainBox2">
		<ul class="slideBox img">
			<li>
				<a href="#">
					<img src="images/1.jpg" alt="">
				</a>
			</li>
			<li>
				<a href="#">
					<img src="images/2.jpg" alt="">
				</a>
			</li>
			<li>
				<a href="#">
					<img src="images/3.jpg" alt="">
				</a>
			</li>
			<li>
				<a href="#">
					<img src="images/4.jpg" alt="">
				</a>
			</li>
			<li>
				<a href="#">
					<img src="images/5.jpg" alt="">
				</a>
			</li>
			<li>
				<a href="#">
					<img src="images/6.jpg" alt="">
				</a>
			</li>
		</ul>


		<ul class="numBox num">
			<li class="active">1</li>
			<li>2</li>
			<li>3</li>
			<li>4</li>
			<li>5</li>
			<li>6</li>
		</ul>

		<div class="preImg left btn">&lt;</div>
		<div class="nextImg right btn">&gt;</div>


	</div>
	<script>
		window.onload = function () {
			var slidebox1 = new SlideBox('mainBox', 730);
			var slidebox2 = new SlideBox('mainBox2', 730);
		}

		function SlideBox(id, imgWidth) {
			var opt = document.getElementById(id);
			var _this = this;
			this.imgWidth = imgWidth;
			this.slideBox = opt.querySelector('.slideBox');
			this.preImg = opt.querySelector('.preImg');
			this.nextImg = opt.querySelector('.nextImg');
			this.numBox = opt.querySelector('.numBox');
			this.numBoxLi = this.numBox.querySelectorAll('li');
			// 自动播放
			this.autoPlay()
			// 点击下一张事件
			this.nextImg.onclick = function () {
				var index = _this.getIndex() > 4 ? -1 : _this.getIndex();
				_this.goTo(index + 1)
			};
			// 点击上一张事件
			this.preImg.onclick = function () {
				var index = _this.getIndex() === 0 ? 6 : _this.getIndex();
				_this.goTo(index - 1)
			};
			// 点击序号跳转到相应屏
			for (let index = 0; index < this.numBoxLi.length; index++) {
				this.numBoxLi[index].onclick = function () {
					_this.removeActive();
					this.autoPlay();
					this.classList.add('active');
					_this.goTo(index);
				}
			};
			// 鼠标移入停止自动播放
			this.slideBox.onmouseover = function () {
				clearInterval(_this.timer)
			};
			// 鼠标移出继续自动播放
			this.slideBox.onmouseout = function () {
				_this.autoPlay();
			};
		}
		// 自动播放定时器
		SlideBox.prototype.autoPlay = function () {
			var _this = this;
			this.timer = setInterval(function () {
				var index = _this.getIndex() > 4 ? -1 : _this.getIndex();
				_this.goTo(index + 1)
			}, 3000)
		}
		// 兼容获取style
		SlideBox.prototype.getStyle = function (obj, attr) {
			return obj.currentStyle ? obj.currentStyle[attr] : getComputedStyle(obj)[attr];
		}
		// 跳转到第index屏
		SlideBox.prototype.goTo = function (index) {
			this.slideBox.style.left = -index * this.imgWidth + 'px';
			this.activeNum(index);
		}
		// 获取当前位置
		SlideBox.prototype.getIndex = function () {
			return Math.abs(parseInt(this.getStyle(this.slideBox, 'left')) / this.imgWidth);
		}
		// 删除高亮
		SlideBox.prototype.removeActive = function () {
			for (let index = 0; index < this.numBoxLi.length; index++) {
				this.numBoxLi[index].classList.remove('active');
			};
		}
		// 高亮数字编号
		SlideBox.prototype.activeNum = function (index) {
			this.removeActive();
			this.numBoxLi[index].classList.add('active')
		}
	</script>

</body>

</html>